SELECT 'tests';
DROP TABLE IF EXISTS has_any_ipv4_str;
CREATE TABLE has_any_ipv4_str (ip String) ENGINE = Memory;
INSERT INTO has_any_ipv4_str (ip) VALUES ('192.168.1.1');
INSERT INTO has_any_ipv4_str (ip) VALUES ('127.0.0.1');
SELECT ip, kql_has_ipv4('XXXX 127.0.0.1', ip) from has_any_ipv4_str;
DROP TABLE has_any_ipv4_str;
DROP TABLE IF EXISTS has_any_ipv4_array;
CREATE TABLE has_any_ipv4_array (ips Array(String)) ENGINE = Memory;
INSERT INTO has_any_ipv4_array (ips) VALUES (['127.0.0.1', '127.0.0.2', '127.0.0.3']);
INSERT INTO has_any_ipv4_array (ips) VALUES (['192.168.0.1', '192.168.0.2']);
SELECT ips, kql_has_any_ipv4('XXX 127.0.0.3', ips) from has_any_ipv4_array;
DROP TABLE has_any_ipv4_array;
SELECT kql_has_any_ipv4('XXX 192.168.0.255', '192.168.0.255', '192.168.0.256');
