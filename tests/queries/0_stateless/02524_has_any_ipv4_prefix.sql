SELECT 'tests';
DROP TABLE IF EXISTS has_any_ipv4_prefix_str;
CREATE TABLE has_any_ipv4_prefix_str (ip String) ENGINE = Memory;
INSERT INTO has_any_ipv4_prefix_str (ip) VALUES ('192.168.1.');
INSERT INTO has_any_ipv4_prefix_str (ip) VALUES ('127.0.0.');
SELECT ip, kql_has_ipv4('XXXX 127.0.0.1', ip) from has_any_ipv4_prefix_str;
DROP TABLE has_any_ipv4_prefix_str;
DROP TABLE IF EXISTS has_any_ipv4_prefix_array;
CREATE TABLE has_any_ipv4_prefix_array (ips Array(String)) ENGINE = Memory;
INSERT INTO has_any_ipv4_prefix_array (ips) VALUES (['127.0.0.1', '127.0.0.2', '127.0.0.3']);
INSERT INTO has_any_ipv4_prefix_array (ips) VALUES (['192.168.0.', '10.']);
SELECT ips, kql_has_any_ipv4_prefix('XXX 127.0.0.3', ips) from has_any_ipv4_prefix_array;
DROP TABLE has_any_ipv4_prefix_array;
SELECT kql_has_any_ipv4_prefix('XXX 192.168.0.255', '192.168.0.', '192.168.0.256');
